"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * @since 0.5.2
 */
var newtype_ts_1 = require("newtype-ts");
var t = require("io-ts");
var Either_1 = require("fp-ts/lib/Either");
/**
 * Returns a codec from a newtype
 *
 * @example
 * import { fromNewtype } from 'io-ts-types/lib/fromNewtype'
 * import * as t from 'io-ts'
 * import { right } from 'fp-ts/lib/Either'
 * import { PathReporter } from 'io-ts/lib/PathReporter'
 * import { Newtype, iso } from 'newtype-ts'
 *
 * interface Token extends Newtype<{ readonly Token: unique symbol }, string> {}
 *
 * const T = fromNewtype<Token>(t.string)
 *
 * assert.deepStrictEqual(T.decode('sometoken'), right(iso<Token>().wrap('sometoken')))
 * assert.deepStrictEqual(PathReporter.report(T.decode(42)), ['Invalid value 42 supplied to : fromNewtype(string)'])
 *
 * @since 0.5.2
 */
function fromNewtype(codec, name) {
    if (name === void 0) { name = "fromNewtype(" + codec.name + ")"; }
    var i = newtype_ts_1.iso();
    return new t.Type(name, function (u) { return codec.is(u); }, function (u, c) { return Either_1.either.map(codec.validate(u, c), i.wrap); }, function (a) { return codec.encode(i.unwrap(a)); });
}
exports.fromNewtype = fromNewtype;
