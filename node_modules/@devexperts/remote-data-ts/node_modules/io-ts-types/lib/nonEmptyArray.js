"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**
 * @since 0.5.0
 */
var t = require("io-ts");
var NonEmptyArray_1 = require("fp-ts/lib/NonEmptyArray");
var Array_1 = require("fp-ts/lib/Array");
var Either_1 = require("fp-ts/lib/Either");
var Option_1 = require("fp-ts/lib/Option");
/**
 * @since 0.5.0
 */
function nonEmptyArray(codec, name) {
    if (name === void 0) { name = "NonEmptyArray<" + codec.name + ">"; }
    var arr = t.array(codec);
    return new t.Type(name, function (u) { return arr.is(u) && Array_1.isNonEmpty(u); }, function (u, c) {
        return Either_1.either.chain(arr.validate(u, c), function (as) {
            var onea = NonEmptyArray_1.fromArray(as);
            return Option_1.isNone(onea) ? t.failure(u, c) : t.success(onea.value);
        });
    }, function (nea) { return arr.encode(nea); });
}
exports.nonEmptyArray = nonEmptyArray;
