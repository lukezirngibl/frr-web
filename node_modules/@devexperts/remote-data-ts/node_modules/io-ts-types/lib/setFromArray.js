"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var Set_1 = require("fp-ts/lib/Set");
var t = require("io-ts");
var Either_1 = require("fp-ts/lib/Either");
/**
 * @since 0.5.0
 */
function setFromArray(codec, O, name) {
    if (name === void 0) { name = "Set<" + codec.name + ">"; }
    var arr = t.array(codec);
    var toArrayO = Set_1.toArray(O);
    var fromArrayO = Set_1.fromArray(O);
    return new t.Type(name, function (u) { return u instanceof Set && Set_1.every(codec.is)(u); }, function (u, c) {
        return Either_1.either.chain(arr.validate(u, c), function (as) {
            var set = fromArrayO(as);
            return set.size !== as.length ? t.failure(u, c) : t.success(set);
        });
    }, function (set) { return arr.encode(toArrayO(set)); });
}
exports.setFromArray = setFromArray;
